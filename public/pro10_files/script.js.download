

(function ($) {
    "use strict";

    /*=====================
     Loader js
     ==========================*/
    $(window).on('load', function () {
        setTimeout(function () {
            $('.loader-wrapper').fadeOut('slow');
            $('.box').addClass('text-affect');
        }, 1000);
        $('.loader-wrapper').remove('slow');
    });

    /*=====================
     Tap to Top
     ==========================*/
    $(window).on('scroll', function () {
        if ($(this).scrollTop() > 600) {
            $('.tap-top').addClass('top');
        } else {
            $('.tap-top').removeClass('top');
        }
    });

    $('.tap-top').on('click', function () {
        $("html, body").animate({
            scrollTop: 0
        }, 600);
        return false;
    });

    /*=====================
      Footer js
     ==========================*/
    var contentwidth = $(window).width();
    $(window).on('load', function () {
        checkPosition();
        function checkPosition() {
            if (window.matchMedia('(max-width: 767px)').matches) {
                $('.footer-title h5').append('<span class="according-menu"><i class="fas fa-chevron-down"></i></span>');
                $('.footer-title').on('click', function () {
                    $('.footer-title').removeClass('active').find('span').replaceWith('<span class="according-menu"><i class="fas fa-chevron-down"></i></span>');
                    $('.footer-content').slideUp('normal');
                    if ($(this).next().is(':hidden') == true) {
                        $(this).addClass('active');
                        $(this).find('span').replaceWith('<span class="according-menu"><i class="fas fa-chevron-up"></i></span>');
                        $(this).next().slideDown('normal');
                    } else {
                        $(this).find('span').replaceWith('<span class="according-menu"><i class="fas fa-chevron-down"></i></span>');
                    }
                });
                $('.footer-content').hide();

            } else {
                $('.footer-content').show();

            }
        }
    });

    /*=====================
      Menu js
     ==========================*/
    // Desktop dropdown
    $('.dropdown').hover(function () {
        if ($(window).width() > 992) {
            $(this).find('.nav-submenu').stop(true, true).delay(200).fadeIn(200);
        }
    }, function () {
        if ($(window).width() > 992) {
            $(this).find('.nav-submenu').stop(true, true).delay(200).fadeOut(200);
        }
    });

    // Mobile dropdown toggle
    $('.dropdown-toggle').click(function (e) {
        e.preventDefault();
        var $submenu = $(this).next('.nav-submenu');
        if ($(window).width() <= 992) {
            if ($submenu.is(':visible')) {
                $(this).find('.fa').removeClass('fa-minus').addClass('fa-plus');
                $submenu.slideUp();
            } else {
                $(this).find('.fa').removeClass('fa-plus').addClass('fa-minus');
                $submenu.slideDown();
            }
        }
    });

    // Sidebar toggle
    $(".toggle-nav, .sidebar-toggle").on('click', function () {
        $('.nav-menu').addClass("open");
        $('.left-sidebar').css("left", "-365px").removeClass("open");
        $('.left-sidebar').removeClass("open");
    });
    $(".mobile-back").on('click', function () {
        $('.nav-menu').removeClass("open");
    });

    // Sticky header
    // $(window).scroll(function () {
    //     $('.header-4').addClass('fixed');
    // });

    $('.zoom-gallery-multiple').magnificPopup({
            delegate: 'a',
            type: 'image',
            closeOnContentClick: false,
            closeBtnInside: false,
            mainClass: 'mfp-with-zoom mfp-img-mobile',
            image: {
                verticalFit: true,
                titleSrc: function (item) {
                    return item.el.attr('title') + ' &middot;';
                }
            },
            gallery: {
                enabled: true,
                navigateByImgClick: true
            },
            zoom: {
                enabled: false,
                duration: 300,
                opener: function (element) {
                    return element.find('img');
                }
            },
            callbacks: {
                open: function () {
                    // Enable mouse navigation
                    var magnificPopup = this;
                    $(document).on('click', '.mfp-arrow', function () {
                        if ($(this).hasClass('mfp-arrow-left')) {
                            magnificPopup.prev();
                        } else {
                            magnificPopup.next();
                        }
                    });
                }
            }
        });

    /*=====================
     Image to background js
     ==========================*/
    $(".bg-img").parent().addClass('bg-size');
    $(".bg-img.blur-up").parent().addClass('blur-up lazyload');
    $('.bg-img').each(function () {

        var el = $(this),
            src = el.attr('src'),
            parent = el.parent();


        parent.css({
            'background-image': 'url(' + src + ')',
            'background-size': 'cover',
            'background-position': 'center',
            'background-repeat': 'no-repeat',
            'display': 'block'
        });

        el.hide();
    });

    /*=====================
    Product listing filter js
    ==========================*/

    $(".view-map").on('click', function () {
        $('.onclick-map').slideToggle('show');
    });

    // advance filter js
    var width_content = $(window).width();

    if (width_content > 991) {
        $(".filter-bottom-title").on('click', function () {
            $(".filter-bottom-content").slideToggle("");
            $(this).toggleClass("activebtntt"); // Toggle active class on click
        });

        $(".close-filter-bottom").on('click', function () {
            $(".filter-bottom-content").css("display", "none");
            $(".filter-bottom-title").removeClass("activebtntt"); // Remove active class when content is closed
        });
    } else {
        $(".filter-bottom-title").on('click', function () {
            $(".filter-bottom-content").toggleClass("open");
            $(this).toggleClass("active"); // Toggle active class on click
        });

        $(".close-filter-bottom").on('click', function () {
            $(".filter-bottom-content").removeClass("open");
            $(".filter-bottom-title").removeClass("active"); // Remove active class when content is closed
        });
    }

})(jQuery);


/*=====================
     Country code phone numbers
    ==========================*/
var input = document.querySelector("#phone");
var userCountry = input.dataset.country;
window.intlTelInput(input, {
    allowExtensions: false,
    autoFormat: false,
    autoHideDialCode: false,
    autoPlaceholder: false,
    separateDialCode: true,
    initialCountry: userCountry,  // This will be set dynamically
    nationalMode: false,
    preventInvalidNumbers: true,
    utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/11.0.14/js/utils.js"
});


/*=====================
    amenities slider checkbox on label click
    ==========================*/
var amenityItems = document.querySelectorAll('.amenity-item');

amenityItems.forEach(function (item) {
    var checkbox = item.querySelector('.amenity-checkbox');
    var label = item.querySelector('.amenity-label');
    label.addEventListener('click', function (event) {
        if (!checkbox.checked) {
            checkbox.checked = true;
        } else {
            checkbox.checked = false;
        }
    });
    item.addEventListener('click', function (event) {
        if (event.target !== label) {
            checkbox.checked = !checkbox.checked;
        }
    });
});

/*=====================
OffPlan Detail page inner navbar
==========================*/
$(window).on('scroll', function () {
    if ($(this).scrollTop() > 600) {
        $('#searchBar').addClass('sticky');
    } else {
        $('#searchBar').removeClass('sticky');

    }
});

var scrollLink = $('#searchBar ul.nav a[href^="#"]');
scrollLink.click(function (e) {
    e.preventDefault();
    $('body,html').animate({
        scrollTop: $(this.hash).offset().top - 140
    }, 500);
});

/*=====================
Active link switching
==========================*/
$(window).scroll(function () {
    var scrollbarLocation = $(this).scrollTop();
    var sections = $('.page-section');
    sections.each(function () {
        var sectionOffset = $(this).offset().top - 180;
        var sectionId = $(this).attr('id');

        if (sectionOffset <= scrollbarLocation) {
            $('a[href="#' + sectionId + '"]').parent().addClass('active');
            $('a[href="#' + sectionId + '"]').parent().siblings().removeClass('active');
        }
    });
});

